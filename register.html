<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>REGISTER</title>
    <link href="LogRegStyle.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
<style>
.infoInput {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-in-out;
    text-align: center;
    font-size: 12px;
}

input:focus + .infoInput {
    max-height: 150px; /* Altezza desiderata quando il messaggio è visibile */
}





.password-input {
    position: relative;
}

.togglePassword {
    color: grey;
    
}
.password-input button{
  border: none;
  position: absolute;
    right: 10px;
    top: 8px;
    padding: 0px;
    cursor: pointer;
  background: none;
}


</style>    
 
</head>
<body>
    <div class="container-fluid">
        <div class="row bdPage">
            <a href="login.html"><i class="fa fa-chevron-left btnBack" aria-hidden="true"> L O G I N</i></a>
            
            <div class="boxLogReg col-10 col-sm-8 col-md-6 col-xl-4 " style="margin-top: 10vh;">
                <h1>Register</h1>
                <p style="font-size: 20px; text-align: center;" class="d-none d-md-block"><span>Registrati</span> ora per <span>sbloccare</span> tutte le <span>features</span> !!</p>
                <p><i class="fa fa-user" aria-hidden="true"></i> Username:</p>
                  <input type="text" id="userInput" placeholder="MarioRossi" >
                  <p class="infoInput">Deve contenere 4-16 caratteri, utilizza caratteri alfanumerici e underscore ( _ )</p>
                <p><i class="fa fa-envelope" aria-hidden="true"></i></i> Email:</p>
                  <input type="email" id="emailInput" name="email" placeholder="Mario.rossi@gmail.com" >
                <p class="infoInput">Formato e-mail valido 'nome@dominio'.</p>
                <p><i class="fa fa-lock" aria-hidden="true"></i> Password:</p>
                <div class="password-input" style="position: relative;">
                  <input type="password" id="pass1Input" placeholder="P4s$w0rd" >
                  <p class="infoInput">Deve contenere almeno 8 caratteri, utilizza una combinazione di lettere maiuscole e minuscole, numeri e caratteri speciali (!@#$%)</p>
                  <button onclick="showPass(this.previousElementSibling.previousElementSibling, this.querySelector('i'))"><i class="fa fa-eye togglePassword"  aria-hidden="true"></i></button>
                    
                </div>               
                  <p><i class="fa fa-lock" aria-hidden="true"></i> Confirm Password:</p>
                  <div class="password-input">
                    <input type="password" id="pass2Input" placeholder="P4s$w0rd" >
                    <p class="infoInput">Ripeti la password inserita precedentemente</p>
                    <button onclick="showPass(this.previousElementSibling.previousElementSibling, this.querySelector('i'))"><i class="fa fa-eye togglePassword"  aria-hidden="true"></i></button>
                  </div>
                  

                <button class="submitBtn" onclick="register()">REGISTER</button>
                <p style="text-align: center;">Hai già un account?<a href="login.html"> Login</a></p>
              </div> 
        </div>
    </div>
  
   
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
  <script src="token.js"></script>
  <script>
    function showPass(passwordInput, icon) {
      
      if (passwordInput.type === "password") {
            icon.classList.remove("fa-eye");
            icon.classList.add("fa-eye-slash");
            passwordInput.type = "text"; // Cambia il tipo a "text" per mostrare la password
        } else {
            passwordInput.type = "password"; // Cambia il tipo a "password" per nascondere la password
            icon.classList.remove("fa-eye-slash");
            icon.classList.add("fa-eye");
        }
}

function register(){
  var username = document.getElementById("userInput")
  var email = document.getElementById("emailInput")
  var pass1 = document.getElementById("pass1Input")
  var pass2 = document.getElementById("pass2Input")

  checkInfo(username, email, pass1, pass2);


}

function checkInfo(username, email, pass1, pass2){
  var usernameV = username.value;
  var emailV = email.value;
  var pass1V = pass1.value;
  var pass2V = pass2.value;
  var errorMessage = "";

if (pass1V.length < 8) {
    errorMessage = "La password deve contenere almeno 8 caratteri.";
} else if (!/[a-z]/.test(pass1V)) {
    errorMessage = "La password deve contenere almeno una lettera minuscola.";
} else if (!/[A-Z]/.test(pass1V)) {
    errorMessage = "La password deve contenere almeno una lettera maiuscola.";
} else if (!/\d/.test(pass1V)) {
    errorMessage = "La password deve contenere almeno un numero.";
} else if (!/[!@#\$%]/.test(pass1V)) {
    errorMessage = "La password deve contenere almeno un carattere speciale (!@#$%).";
}

if (errorMessage) {
    // Mostra il messaggio di errore
    showErrMess(errorMessage, pass1);
    
}

if(pass1V != pass2V){
  showErrMess("Le password non coincidono",pass2);
}
}

function showErrMess(errorMessage, element){
  var prevContent = element.nextElementSibling.innerHTML
  var textInfo = element.nextElementSibling;
  textInfo.innerHTML = errorMessage;
  textInfo.style.maxHeight = "150px";

  element.style.outline = "2px solid #ff1919b7";

    element.addEventListener("focus", function() {

      textInfo.innerHTML = prevContent;
      textInfo.style.maxHeight = "";
        element.style.outline = "";
    });
}
        
 
  </script>
 
    
</body>
</html>